import tkinter as tk
from tkinter import ttk
from tkinter import messagebox
import subprocess

def analyze_vulnerabilities_gui():
    vulnerability_window = tk.Toplevel()
    vulnerability_window.title("Analyze Vulnerabilities")
    vulnerability_window.geometry("600x400")

    instructions_label = ttk.Label(vulnerability_window, text="Select the type of vulnerability analysis:")
    instructions_label.pack(pady=10)

    analysis_options = ["WEP Encryption Vulnerability", "Common Vulnerabilities"]
    analysis_var = tk.StringVar(value=analysis_options[0])

    analysis_dropdown = ttk.OptionMenu(vulnerability_window, analysis_var, *analysis_options)
    analysis_dropdown.pack(pady=10)

    analyze_button = ttk.Button(vulnerability_window, text="Analyze", command=lambda: run_vulnerability_analysis(analysis_var.get()))
    analyze_button.pack(pady=20)

def run_vulnerability_analysis(selected_analysis):
    if selected_analysis == "WEP Encryption Vulnerability":
        cmd = ["airodump-ng", "wlan0mon", "--encrypt", "wep"]
    else:  # For "Common Vulnerabilities"
        cmd = ["nmap", "-sV", "--script=vuln", "192.168.1.0/24"]
    
    try:
        subprocess.run(cmd, check=True, capture_output=True, text=True)
        messagebox.showinfo("Analysis Complete", f"{selected_analysis} analysis completed successfully.")
    except subprocess.CalledProcessError as e:
        messagebox.showerror("Analysis Error", f"Failed to complete {selected_analysis} analysis: {e.stderr}")